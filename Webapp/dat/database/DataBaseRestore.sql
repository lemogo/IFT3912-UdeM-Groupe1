--SCRIPT  
CREATE USER IF NOT EXISTS GROUP1 SALT 'bd82ec3b5ae7f0fd' HASH '4241a671a59ff67476820f0f0aed6ad9e09a33102e265338f725b3d697dca489' ADMIN;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_B37B478A_2D65_4AD1_A428_C9B7BE82B8B3 START WITH 4 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_5A541C92_F5C1_46E9_86B6_E50D1F878C5F START WITH 4 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_C09717A3_821F_419E_8394_771197021448 START WITH 4 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_9CE4893D_EBA3_44E6_B18F_ED8C3F931896 START WITH 4 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_3575D9B0_B644_4A92_BA20_786D02CABD36 START WITH 4 BELONGS_TO_TABLE;
CREATE CACHED TABLE PUBLIC.SIGNEDUSER( 
    SUSERID INT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_3575D9B0_B644_4A92_BA20_786D02CABD36) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_3575D9B0_B644_4A92_BA20_786D02CABD36, 
    USERNAME VARCHAR(50) NOT NULL, 
    PASSWORD VARCHAR(50) NOT NULL, 
    FULLNAME VARCHAR(50) NOT NULL, 
    EMAIL VARCHAR(50) NOT NULL, 
    AGE DATE NOT NULL, 
    DESCRIPTION CHAR(500) NOT NULL, 
    DATECREATION DATETIME DEFAULT CURRENT_TIMESTAMP() 
);
ALTER TABLE PUBLIC.SIGNEDUSER ADD CONSTRAINT PUBLIC.CONSTRAINT_E PRIMARY KEY(SUSERID, EMAIL);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.SIGNEDUSER;
INSERT INTO PUBLIC.SIGNEDUSER(SUSERID, USERNAME, PASSWORD, FULLNAME, EMAIL, AGE, DESCRIPTION, DATECREATION) VALUES 
(1, 'pat', 'patson', STRINGDECODE('patrice m\u00e9chant'), 'patrice@mechant.fun', DATE '2014-05-25', STRINGDECODE('Je suis un passionn\u00e9 de jet extreme activit\u00e9 trop cool'), TIMESTAMP '2014-04-17 15:04:21.587'), 
(2, 'will', 'wilson', 'willy gentle', 'matresack@ndjeuptien.va', DATE '2001-04-15', 'Jaime faire du patin et tomber mille fois', TIMESTAMP '2014-04-17 15:04:21.59'), 
(3, 'gil', 'gilson', 'beau goss', 'beau@ndjeuptien.va', DATE '1902-05-25', 'la natation me passione', TIMESTAMP '2014-04-17 15:04:21.591');
CREATE CACHED TABLE PUBLIC.SESSIONUSER( 
    SESSIONID INT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_5A541C92_F5C1_46E9_86B6_E50D1F878C5F) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_5A541C92_F5C1_46E9_86B6_E50D1F878C5F, 
    DATECREATION DATE NOT NULL, 
    DATECLOSING DATE, 
    EMAIL VARCHAR(50) NOT NULL 
);
ALTER TABLE PUBLIC.SESSIONUSER ADD CONSTRAINT PUBLIC.CONSTRAINT_7 PRIMARY KEY(SESSIONID, EMAIL);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.SESSIONUSER;
INSERT INTO PUBLIC.SESSIONUSER(SESSIONID, DATECREATION, DATECLOSING, EMAIL) VALUES 
(1, DATE '2014-04-17', NULL, 'patrice@mechant.fun'), 
(2, DATE '2014-04-17', NULL, 'matresack@ndjeuptien.va'), 
(3, DATE '2014-04-17', NULL, 'beau@ndjeuptien.va');
CREATE CACHED TABLE PUBLIC.EVENT( 
    EVENTID INT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_B37B478A_2D65_4AD1_A428_C9B7BE82B8B3) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_B37B478A_2D65_4AD1_A428_C9B7BE82B8B3, 
    TITLE VARCHAR(255) NOT NULL, 
    SUSERID INT NOT NULL, 
    DATEEVENT DATETIME NOT NULL, 
    LOCATION VARCHAR(255) NOT NULL, 
    DESCRIPTION CHAR(500) NOT NULL, 
    DATECREATION DATETIME DEFAULT CURRENT_TIMESTAMP(), 
    NUMBERPLACES INT NOT NULL, 
    HEURE TIME, 
    STATUS VARCHAR(50) DEFAULT 'running' CHECK (STATUS IN('cancelled', 'deleted', 'running')), 
    TYPE VARCHAR(50) 
);
ALTER TABLE PUBLIC.EVENT ADD CONSTRAINT PUBLIC.CONSTRAINT_3 PRIMARY KEY(EVENTID);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.EVENT;
INSERT INTO PUBLIC.EVENT(EVENTID, TITLE, SUSERID, DATEEVENT, LOCATION, DESCRIPTION, DATECREATION, NUMBERPLACES, HEURE, STATUS, TYPE) VALUES 
(1, 'badminton ', 1, TIMESTAMP '2015-01-01 10:30:00.0', 'cote des neiges', 'venez jouer avec nous', TIMESTAMP '2014-04-17 15:04:21.594', 10, TIME '01:02:00', 'running', 'sport'), 
(2, 'course ', 2, TIMESTAMP '2000-05-15 12:00:00.0', 'gatineau', 'course folle', TIMESTAMP '2014-04-17 15:04:21.595', 8, TIME '04:02:30', 'cancelled', 'danse'), 
(3, 'course ', 3, TIMESTAMP '2002-11-11 08:00:00.0', 'gatineau', 'course folle', TIMESTAMP '2014-04-17 15:04:21.596', 8, TIME '04:02:30', 'cancelled', 'danse');
CREATE CACHED TABLE PUBLIC.COMMENTEVENT( 
    COMMENTID INT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_9CE4893D_EBA3_44E6_B18F_ED8C3F931896) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_9CE4893D_EBA3_44E6_B18F_ED8C3F931896, 
    DESCRIPTION CHAR(500) NOT NULL, 
    DATECREATION DATETIME DEFAULT CURRENT_TIMESTAMP(), 
    EVENTID INT NOT NULL, 
    SUSERID INT NOT NULL 
);
ALTER TABLE PUBLIC.COMMENTEVENT ADD CONSTRAINT PUBLIC.CONSTRAINT_B PRIMARY KEY(COMMENTID);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.COMMENTEVENT;
INSERT INTO PUBLIC.COMMENTEVENT(COMMENTID, DESCRIPTION, DATECREATION, EVENTID, SUSERID) VALUES 
(1, 'cool comme event', TIMESTAMP '2014-04-17 15:04:21.597', 1, 1), 
(2, 'genial je kiff', TIMESTAMP '2014-04-17 15:04:21.598', 1, 2), 
(3, 'bon timing', TIMESTAMP '2014-04-17 15:04:21.598', 2, 1);
CREATE CACHED TABLE PUBLIC.SUBSEVENTGENERAL( 
    EVENTID INT NOT NULL, 
    GUSERID INT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_C09717A3_821F_419E_8394_771197021448) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_C09717A3_821F_419E_8394_771197021448 
);
ALTER TABLE PUBLIC.SUBSEVENTGENERAL ADD CONSTRAINT PUBLIC.CONSTRAINT_E0 PRIMARY KEY(EVENTID, GUSERID);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.SUBSEVENTGENERAL;
INSERT INTO PUBLIC.SUBSEVENTGENERAL(EVENTID, GUSERID) VALUES 
(1, 1), 
(2, 2), 
(1, 3);
CREATE CACHED TABLE PUBLIC.SUBSEVENTSIGNED( 
    EVENTID INT NOT NULL, 
    SUSERID INT NOT NULL, 
    NOTIFICATION VARCHAR(50) DEFAULT 'notyet' CHECK (NOTIFICATION IN('already', 'notyet')) 
);
ALTER TABLE PUBLIC.SUBSEVENTSIGNED ADD CONSTRAINT PUBLIC.CONSTRAINT_D PRIMARY KEY(EVENTID, SUSERID);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.SUBSEVENTSIGNED;
INSERT INTO PUBLIC.SUBSEVENTSIGNED(EVENTID, SUSERID, NOTIFICATION) VALUES 
(1, 1, 'notyet'), 
(2, 2, 'notyet'), 
(1, 2, 'notyet');
ALTER TABLE PUBLIC.SESSIONUSER ADD CONSTRAINT PUBLIC.CONSTRAINT_7F FOREIGN KEY(EMAIL) REFERENCES PUBLIC.SIGNEDUSER(EMAIL) ON DELETE CASCADE ON UPDATE CASCADE NOCHECK;
ALTER TABLE PUBLIC.EVENT ADD CONSTRAINT PUBLIC.CONSTRAINT_3F FOREIGN KEY(SUSERID) REFERENCES PUBLIC.SIGNEDUSER(SUSERID) ON DELETE CASCADE ON UPDATE CASCADE NOCHECK;
ALTER TABLE PUBLIC.SUBSEVENTGENERAL ADD CONSTRAINT PUBLIC.CONSTRAINT_E01 FOREIGN KEY(EVENTID) REFERENCES PUBLIC.EVENT(EVENTID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.COMMENTEVENT ADD CONSTRAINT PUBLIC.CONSTRAINT_B9E FOREIGN KEY(SUSERID) REFERENCES PUBLIC.SIGNEDUSER(SUSERID) ON DELETE CASCADE ON UPDATE CASCADE NOCHECK;
ALTER TABLE PUBLIC.COMMENTEVENT ADD CONSTRAINT PUBLIC.CONSTRAINT_B9 FOREIGN KEY(EVENTID) REFERENCES PUBLIC.EVENT(EVENTID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.SUBSEVENTSIGNED ADD CONSTRAINT PUBLIC.CONSTRAINT_D9D FOREIGN KEY(SUSERID) REFERENCES PUBLIC.SIGNEDUSER(SUSERID) ON DELETE CASCADE ON UPDATE CASCADE NOCHECK;
ALTER TABLE PUBLIC.SUBSEVENTSIGNED ADD CONSTRAINT PUBLIC.CONSTRAINT_D9 FOREIGN KEY(EVENTID) REFERENCES PUBLIC.EVENT(EVENTID) ON DELETE CASCADE NOCHECK;